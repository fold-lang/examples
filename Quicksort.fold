-- Quicksort

def qsort input =
  match input
  | [] | [_] -> input
  | [x & xs] ->
    let (less, more) = List.partition (\x < p) xs in
    qsort less ++ [x & qsort more]
  end

